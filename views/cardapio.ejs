<!DOCTYPE html>
<html lang="pt-br">
<head>
  <%- include('partials/head', { title: 'Cardápio' }) %>
</head>
<body class="bg-stone-100 min-h-screen font-sans text-stone-800">

<div class="flex">
  <%- include('partials/sidebar', { active: 'cardapio' }) %>

  <main class="flex-1 p-8">
    <div class="max-w-5xl mx-auto">
      <h1 class="text-3xl font-bold text-stone-900 mb-2">Cardápio</h1>
      <p class="text-stone-500 mb-8">Itens que o agente oferece aos clientes. Pratos e bebidas.</p>

      <% if (typeof erro !== 'undefined' && erro) { %>
        <div class="mb-6 p-4 rounded-xl bg-amber-50 border border-amber-200 text-amber-800 text-sm">
          <%= erro %>
        </div>
      <% } %>

      <!-- Lista -->
      <div class="bg-white rounded-2xl shadow-sm border border-stone-200/80 overflow-hidden mb-8">
        <div class="px-6 py-4 border-b border-stone-100">
          <h2 class="text-lg font-semibold text-stone-800">Itens do cardápio</h2>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="bg-stone-50 border-b border-stone-200">
                <th class="text-left py-4 px-6 text-sm font-semibold text-stone-600">Nome</th>
                <th class="text-left py-4 px-6 text-sm font-semibold text-stone-600">Descrição</th>
                <th class="text-left py-4 px-6 text-sm font-semibold text-stone-600">Categoria</th>
                <th class="text-left py-4 px-6 text-sm font-semibold text-stone-600">Preço</th>
                <th class="text-left py-4 px-6 text-sm font-semibold text-stone-600">Ativo</th>
                <th class="text-left py-4 px-6 text-sm font-semibold text-stone-600">Ações</th>
              </tr>
            </thead>
            <tbody>
              <% itens.forEach(function(item) { %>
                <tr class="border-b border-stone-100 hover:bg-amber-50/30 transition">
                  <td class="py-4 px-6 font-medium text-stone-800"><%= item.nome %></td>
                  <td class="py-4 px-6 text-stone-500 text-sm"><%= item.descricao || '—' %></td>
                  <td class="py-4 px-6">
                    <span class="inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium <%= item.categoria === 'bebida' ? 'bg-blue-100 text-blue-800' : 'bg-amber-100 text-amber-800' %>">
                      <%= item.categoria || 'prato' %>
                    </span>
                  </td>
                  <td class="py-4 px-6 font-semibold text-green-700">R$ <%= Number(item.preco).toFixed(2) %></td>
                  <td class="py-4 px-6">
                    <% if (item.ativo) { %>
                      <span class="text-green-600 font-medium">Sim</span>
                    <% } else { %>
                      <span class="text-stone-400">Não</span>
                    <% } %>
                  </td>
                  <td class="py-4 px-6">
                    <a href="/admin/cardapio/editar/<%= item.id %>" class="text-amber-600 hover:text-amber-700 font-medium text-sm mr-4">Editar</a>
                    <form method="POST" action="/admin/cardapio/excluir/<%= item.id %>" class="inline" onsubmit="return confirm('Excluir este item?');">
                      <button type="submit" class="text-red-600 hover:text-red-700 font-medium text-sm">Excluir</button>
                    </form>
                  </td>
                </tr>
              <% }); %>
            </tbody>
          </table>
        </div>
        <% if (itens.length === 0) { %>
          <div class="py-12 text-center text-stone-500">Nenhum item no cardápio. Adicione abaixo.</div>
        <% } %>
      </div>

      <!-- Adicionar -->
      <div class="bg-white rounded-2xl shadow-sm border border-stone-200/80 p-6">
        <h2 class="text-lg font-semibold text-stone-800 mb-4">Adicionar item</h2>
        <form method="POST" action="/admin/cardapio/add" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-stone-600 mb-1.5">Nome</label>
            <input name="nome" placeholder="Ex: X-Burger" required class="w-full border border-stone-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-stone-600 mb-1.5">Preço (R$)</label>
            <input name="preco" type="number" step="0.01" min="0" placeholder="25.00" required class="w-full border border-stone-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500">
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-stone-600 mb-1.5">Descrição (opcional)</label>
            <input name="descricao" placeholder="Ex: Hambúrguer artesanal" class="w-full border border-stone-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-stone-600 mb-1.5">Categoria</label>
            <select name="categoria" class="w-full border border-stone-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500">
              <option value="prato">Prato</option>
              <option value="bebida">Bebida</option>
            </select>
          </div>
          <div class="flex items-center">
            <label class="flex items-center gap-2 cursor-pointer">
              <input name="ativo" type="checkbox" checked class="rounded border-stone-300 text-amber-600 focus:ring-amber-500">
              <span class="text-sm text-stone-600">Ativo (aparece no cardápio do agente)</span>
            </label>
          </div>
          <div class="md:col-span-2">
            <button type="submit" class="bg-amber-600 hover:bg-amber-700 text-white font-medium px-6 py-2.5 rounded-xl transition shadow-sm">Adicionar</button>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>

</body>
</html>
